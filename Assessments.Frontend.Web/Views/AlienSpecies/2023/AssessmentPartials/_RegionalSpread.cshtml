@model RegionalSpreadViewModel;
@using Assessments.Mapping.AlienSpecies.Model.Enums;

@{
    var showPage = Model.Category != AlienSpeciesAssessment2023Category.NR;
    var showTableAndThreeMaps = Model.AlienSpeciesCategory == AlienSpeciecAssessment2023AlienSpeciesCategory.AlienSpecie;
    var showTableAndSingleMap = Model.AlienSpeciesCategory == AlienSpeciecAssessment2023AlienSpeciesCategory.DoorKnocker ||
        Model.AlienSpeciesCategory == AlienSpeciecAssessment2023AlienSpeciesCategory.EffectWithoutReproduction;
    var showInteractiveMap = showTableAndThreeMaps && false; // TODO: switch false with has used artskart and downloaded a zip file
    var showCurrentPresenceComment = !string.IsNullOrEmpty(Model.CurrentPresenceComment);

    var knownToday = new MapViewModel
    {
        MapText = Constants.AlienSpecies2023KnownOccurence,
        RegionOccurrences = Model.RegionOccurrences.Where(x => x.IsKnown == true).ToList()
    };

    var isAssumedToday = new MapViewModel
    {
        MapText = Constants.AlienSpecies2023AssumedOccurence,
        RegionOccurrences = Model.RegionOccurrences.Where(x => x.IsAssumedToday == true).ToList()
    };

    var isAssumedInFuture = new MapViewModel
    {
        MapText = Constants.AlienSpecies2023AssumedInFutureOccurence,
        RegionOccurrences = Model.RegionOccurrences.Where(x => x.IsAssumedInFuture == true).ToList()
    };
}

<div id="geographical_spread" class="page_section" is-visible="@showPage">
    <h2>
        Utbredelse
    </h2>
    <button id="domestic_spread_button" class="changetab active" onclick="selectTab('domestic_spread_button', 'domestic_spread' , 'geographical_spread' )">Utbredelse i Norge</button>
    <button id="regional_nature_variation_button" class="changetab" onclick="selectTab('regional_nature_variation_button', 'regional_nature_variation' , 'geographical_spread' )">Regional naturvariasjon</button>
    <div class="tabbed_element_container assessment_tabs">
        <div id="domestic_spread">
            <div id="show_occurence_area" class="collapsible initially_closed">
                <div class="collapsible_header">
                    <h3>Forekomstareal</h3>
                    <button class="hide" onclick="toggleCollapsible(this)">
                        <span class="material-icons expanded_icon">expand_less</span>
                        <span class="material-icons collapsed_icon">expand_more</span>
                    </button>
                </div>
                <div class="collapsible_content">

                    
                    <table class="numbers-table">

                        <tr>
                            <th>Forekomst</th>
                            <th>I dag </th>
                            <th>Fremtidig (50 år) </th>
                        </tr>
                        <tr>
                            <td>Kjent  </td>
                            <td>@Model.AreaOfOccupancyKnown km<sup>2</sup></td>
                            <td></td>
                        </tr>

                        <tr>
                            <td>Antatt lavt anslag</td> 
                            <td>@Model.AreaOfOccupancyTotalLow km<sup>2</sup></td>
                            <td>@Model.AreaOfOccupancyFutureLow km<sup>2</sup></td>
                        </tr>
                        <tr>
                            <td>Antatt beste anslag</td>
                            <td>@Model.AreaOfOccupancyTotalBest km<sup>2</sup></td>
                            <td>@Model.AreaOfOccupancyFutureBest km<sup>2</sup></td>
                        </tr>
                        <tr>
                            <td>Antatt høyt anslag</td>
                            <td>@Model.AreaOfOccupancyTotalHigh km<sup>2</sup></td>
                            <td>@Model.AreaOfOccupancyFutureHigh km<sup>2</sup></td>
                        </tr>

                    </table>


                    <div is-visible="@showTableAndThreeMaps">
                        <div class="map triple_map">
                            <partial name="/Views/AlienSpecies/2023/AssessmentPartials/_Map2018.cshtml" model="knownToday" />
                            <partial name="/Views/AlienSpecies/2023/AssessmentPartials/_Map2018.cshtml" model="isAssumedToday" />
                            <partial name="/Views/AlienSpecies/2023/AssessmentPartials/_Map2018.cshtml" model="isAssumedInFuture"/>
                        </div>
                        <p>Tabellvisning + legende</p>
                    </div> 
                    <div is-visible="@showTableAndSingleMap">
                        <div>
                            <partial name="/Views/AlienSpecies/2023/AssessmentPartials/_Map2018.cshtml" model="isAssumedInFuture"/>
                        </div>
                        <div>
                            tabell
                        </div>                        
                    </div>
                    <div is-visible="showCurrentPresenceComment">
                        <p>
                            Grunnlaget for og/eller antagelsene bak anslagene på regionvis utbredelse og 
                            forekomstareal om 50 år.
                        </p>
                        <p>@Html.Raw(Model.CurrentPresenceComment)</p>
                    </div>
                    <div is-visible="@showInteractiveMap">
                        Interaktivt kart
                    </div>
                </div>
            </div>
        </div>
        <div id="regional_nature_variation">
            regional_nature_variation
        </div>
    </div>
</div>
