@model Artsdatabanken.RL2021
@* SEE example by searching species Bombus hyperboreus *@

@{
    Artsdatabanken.RL2021 assessment = Model;

    var kriteriedok =  assessment.Kriteriedokumentasjon;
    kriteriedok = "<p>" + kriteriedok.Replace("<br/>", "</p><p>")+"<p>";
    kriteriedok = kriteriedok.Replace("<b>", "<h4>");
    kriteriedok = kriteriedok.Replace("</b>", "</h4>");
    kriteriedok = kriteriedok.Replace("<u>", "<h4>");
    kriteriedok = kriteriedok.Replace("</u>", "</h4>");
}



@if (!((Model.Kategori == "NA" || Model.Kategori == "NE" || Model.Kategori == "LC") && (Model.Kriteriedokumentasjon == "" || Model.Kriteriedokumentasjon == null)))
{

    <div class="page_section">
        <h2>Oppsumering av vurdering</h2>

        @if (Model.Kategori.IndexOf("CR") >= 0 || Model.Kategori.IndexOf("EN") >= 0 || Model.Kategori.IndexOf("VU") >= 0 || Model.Kategori.IndexOf("NT") >= 0)
        {
            <h3>Gjeldende kriterier</h3>
            <p><b>@Model.Kriterier</b></p>
            <p class="fact_box">@ViewBag.glossary["oneliners"]["gjeldendekriterier"]</p>
        }

        <!-- Kategori endring -->
        @if (!string.IsNullOrEmpty(Model.KategoriEndretTil) && Model.UtdøingSterktPåvirket == "Ja")
        {<h3>Kategori-endring</h3>
            <div>Kategori endret til: @assessment.KategoriEndretTil</div>
        }

        <!-- Kategori Kriteriedokumentasjon -->
        @if (!string.IsNullOrWhiteSpace(assessment.Kriteriedokumentasjon))
        {
            <h3>Vurdering</h3>
            
             @Html.Raw(kriteriedok)
           
        }

        <!-- Kategori UtdøingSterktPåvirket -->
        @if (assessment.UtdøingSterktPåvirket == "Ja")
        {
            <h3>Er utdøing Påvirket?</h3>
            @if (assessment.KategoriEndretFra != "" && assessment.KategoriEndretFra != null)
            {
                <div class="changedCat">Risiko for utdøing er sterkt påvirket av populasjoner i naboland. Kategori er derfor justert fra @assessment.KategoriEndretFra til @assessment.KategoriEndretTil. @Html.Raw(@assessment.ÅrsakTilNedgraderingAvKategori)</div>
            }
            else
            {
                <div class="changedCat">Risiko for utdøing er sterkt påvirket av populasjoner i naboland. Kategori er derfor justert til @assessment.KategoriEndretTil. @Html.Raw(@assessment.ÅrsakTilNedgraderingAvKategori)</div>
            }

        }

        <!-- Årsak til endring av kategori -->
        @if (!string.IsNullOrWhiteSpace(assessment.ÅrsakTilEndringAvKategori) && assessment.KategoriFraForrigeListe != assessment.Kategori)
        {
            <h3>Årsak til endring av kategori</h3>
            <div class="changedCat">Kategorien er endret fra forrige rødlistevurdering på grunn av @assessment.ÅrsakTilEndringAvKategori.Substring(0, 1).ToLower()@assessment.ÅrsakTilEndringAvKategori.Substring(1).</div>
        }


        <!-- Generasjonslengde-->
        @if (Model.Generasjonslengde != "" && Model.Generasjonslengde != null)
        {
            <h3>Generasjonstid: @assessment.Generasjonslengde år</h3>
            <p class="fact_box">
                @ViewBag.glossary["generasjonstid"]["description"]
            </p>
        }
    </div><!-- End section -->
}
